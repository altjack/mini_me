# ==========================================
# Configurazione Agent Daily Report GA4
# ==========================================

# Configurazione Agente AI
agent:
  # Modello Anthropic da utilizzare
  # Opzioni: "claude-sonnet-4.5", "claude-haiku-4-5-20251001"
  model: "claude-sonnet-4-5-20250929"
  
  # Verbose output durante l'esecuzione
  verbose: true

# Configurazione Database (SQLite + Redis Cache)
database:
  sqlite:
    # Percorso file database SQLite
    path: "data/ga4_data.db"
    
    # Backup automatico abilitato
    backup_enabled: true
    
    # Directory per backup
    backup_dir: "data/backups"
    
    # Frequenza backup (weekly, daily)
    backup_frequency: "weekly"
  
  redis:
    # Host Redis (default: localhost)
    host: "localhost"
    
    # Porta Redis (default: 6379)
    port: 6379
    
    # Database Redis per cache GA4 (1 = separato da memoria agente)
    db: 1
    
    # Prefisso chiavi Redis per metriche GA4
    key_prefix: "ga4:metrics:"
    
    # TTL cache in giorni (sliding window ultimi 14 giorni)
    ttl_days: 14

# Configurazione Redis per memoria agente (deprecato - ora in database.redis)
redis:
  # Host Redis (default: localhost per installazione locale)
  host: "localhost"
  
  # Porta Redis (default: 6379)
  port: 6379
  
  # Database Redis da utilizzare (0-15)
  db: 0
  
  # Prefisso chiavi Redis per questa applicazione
  # Tutte le chiavi useranno questo prefisso per evitare conflitti
  memory_prefix: "agent:memory:weborder"

# Configurazione GA4 Extraction
ga4_extraction:
  # Giorni di storico per backfill iniziale
  backfill_days: 365
  
  # Offset giorni per confronto (default: 7 giorni prima)
  comparison_offset: 7

# Configurazione Esecuzione
execution:
  # Cartella contenente i CSV generati dal cron job (LEGACY - ora usa database)
  data_source: "output"
  
  # Cartella dove salvare le email generate
  output_dir: "email"
  
  # Nome file draft email corrente
  draft_filename: "draft_email.md"
  
  # Cartella archivio email approvate
  archive_dir: "email/archive"
  
  # Prompt task per l'agente
  # Questo è il prompt iniziale che viene inviato all'agente quando eseguito
  task_prompt: >
    GENERA L'EMAIL COMPLETA DEL REPORT GIORNALIERO GA4.
    
    ISTRUZIONI:
    
    1. ACQUISISCI I DATI:
       - Usa get_metrics_summary(period_days=1) per ottenere i dati più recenti
       - Se necessario, usa get_daily_report() per dettagli aggiuntivi
    
    2. SCRIVI L'EMAIL COMPLETA usando come riferimento PRIMARIO gli esempi storici che hai nel system prompt:
       - EMULA lo stile discorsivo e analitico degli esempi
       - REPLICA la struttura narrativa (non un template rigido, ma il "flusso" degli esempi)
       - USA espressioni e formule simili a quelle che vedi negli esempi
       - MANTIENI il tono professionale ma accessibile degli esempi
       - EVIDENZIA le metriche chiave come fatto negli esempi (SWI, prodotti, sessioni, CR)
    
    3. CONTENUTO OBBLIGATORIO:
       - Performance SWI con variazioni percentuali e confronti temporali
       - Dettaglio prodotti (Fixa, Pernoi, Trend, Sempre) con percentuali
       - Sessioni commodity e Luce&Gas con trend
       - Conversion Rates (CR commodity, CR Luce&Gas, CR canalizzazione)
       - Analisi contestuale e insights (come negli esempi storici)
    
    4. REQUISITI TECNICI:
       - USA SOLO dati REALI dai tool (NO placeholder, NO invenzioni)
       - Scrivi l'email COMPLETA immediatamente dopo aver ottenuto i dati
       - NON limitarti a dire "procederò a scrivere" - SCRIVI direttamente
       - Formato markdown, pronta per essere salvata
    
    IMPORTANTE: Il tuo output finale DEVE essere l'EMAIL COMPLETA, scritta nello stile appreso dagli esempi storici.

# Configurazione Email Examples
examples:
  # File contenente esempi email storiche
  source_file: "history.md"
  
  # Numero esempi da includere nel context
  sample_size: 15
  
  # Strategia sampling ("recent_weighted", "recent", "random")
  sampling_strategy: "recent_weighted"
  
  # Token budget massimo per esempi (safety)
  max_tokens: 7000

# Configurazione File Conversazione (DEPRECATED - usa examples sopra)

# Configurazione Logging
logging:
  # Livello log (DEBUG, INFO, WARNING, ERROR, CRITICAL)
  level: "INFO"
  
  # File log per operazioni agente
  agent_log: "agent_execution.log"
  
  # File log per operazioni memoria
  memory_log: "memory_operations.log"

# Opzioni Avanzate
advanced:
  # Numero massimo messaggi da includere nel contesto memoria
  # null = tutti i messaggi, numero = limita agli ultimi N
  max_memory_messages: null
  
  # Timeout esecuzione agente in secondi
  agent_timeout: 300
  
  # Salva automaticamente logs delle esecuzioni
  save_execution_logs: true
  
  # Formato timestamp per file archiviati
  timestamp_format: "%Y%m%d_%H%M%S"

